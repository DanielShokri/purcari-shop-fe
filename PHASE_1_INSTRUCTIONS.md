# Phase 1: Convex Code Generation & Module Resolution

## Quick Start

Run these commands in order:

```bash
# Step 1: Generate Convex types
npx convex codegen

# Step 2: Check TypeScript errors (should be ~30-40 remaining)
npx tsc --noEmit 2>&1 | head -50

# Step 3: Count remaining errors
npx tsc --noEmit 2>&1 | grep "error TS" | wc -l

# Step 4: Group errors by file
npx tsc --noEmit 2>&1 | cut -d: -f1 | sort | uniq -c | sort -rn | head -20
```

---

## Expected Results After Phase 1

**Before:** 78 errors
**After:** ~30-40 errors

**Errors that should disappear:**
- ✅ `Cannot find module '@convex/_generated/api'`
- ✅ `Cannot find module '@convex/_generated/dataModel'`
- ✅ `Cannot find module '@convex/api'`

**Errors that will remain:**
- ❌ Type shape mismatches (CartRule, Product types)
- ❌ Missing exports (useCouponFlow)
- ❌ Number vs bigint
- ❌ Query type incompatibilities

---

## What Is Convex Code Generation Doing?

```
convex/
├── schema.ts          (your data model definition)
├── functions/
│   ├── products.ts
│   ├── users.ts
│   └── ...
└── _generated/        ← Generated by 'npx convex codegen'
    ├── api.ts         (type-safe API references)
    ├── api.d.ts
    └── dataModel.ts   (Convex document types)
```

When you run `npx convex codegen`:
1. Reads `convex/schema.ts`
2. Generates TypeScript types for all documents
3. Creates type-safe API references
4. Makes imports like `@convex/_generated/api` work

This is REQUIRED before TypeScript can resolve your Convex imports.

---

## If Errors Don't Decrease Much

**Check these things:**

1. **Verify Convex setup:**
   ```bash
   ls convex/_generated/
   # Should show: api.d.ts, api.ts, dataModel.d.ts, dataModel.ts
   ```

2. **Check convex.json exists:**
   ```bash
   cat convex.json
   # Should have teamsApiUrl and other config
   ```

3. **Verify packages are installed:**
   ```bash
   npm list convex @convex/react
   ```

4. **Check tsconfig paths:**
   ```bash
   cat tsconfig.json | grep "@convex"
   # Should have paths defined
   ```

---

## Phase 1 Complete When:

- [ ] `npx convex codegen` runs without errors
- [ ] `convex/_generated/` folder has files
- [ ] `npx tsc --noEmit` shows ~30-40 errors (was 78)
- [ ] Module resolution errors mostly gone

---

## Ready for Phase 2?

Once Phase 1 is done, we'll focus on:
1. **Type adapters** for Convex vs Appwrite schema
2. **Export fixes** for missing named exports
3. **Form type separation** for react-hook-form compatibility

Each error gets fixed one by one with verification.
