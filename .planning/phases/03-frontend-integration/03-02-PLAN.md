---
phase: 03-frontend-integration
plan: 02
type: execute
wave: 3
depends_on: [03-01]
files_modified: [apps/storefront/services/api/productsApi.ts, apps/storefront/hooks/useProducts.ts]
autonomous: true
must_haves:
  truths:
    - "Convex useQuery replaces RTK Query for product fetching"
    - "Product list and search continue to function correctly"
---

<objective>
Migrate the product catalog and search logic in the Storefront from Appwrite to Convex.
</objective>

<execution_context>
@/Users/danielshmuel.mirshukri/.config/opencode/get-shit-done/workflows/execute-plan.md
</execution_context>

<context>
@.planning/STATE.md
@.planning/ROADMAP.md
@apps/storefront/index.tsx
@convex/products.ts
@apps/storefront/services/api/productsApi.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Identify Product Consumption Points</name>
  <files>apps/storefront/services/api/productsApi.ts</files>
  <action>
    - Find all components using `useGetProductsQuery`, `useGetProductByIdQuery`, etc.
    - Identify the data structure expected by the UI.
  </action>
  <verify>List the main components needing migration.</verify>
  <done>Consumption points are identified.</done>
</task>

<task type="auto">
  <name>Task 2: Replace Hooks in UI Components</name>
  <files>apps/storefront/pages/Products.tsx, apps/storefront/pages/ProductDetail.tsx</files>
  <action>
    - Replace `useGetProductsQuery` with Convex `useQuery(api.products.list, { ... })`.
    - Replace search logic with Convex `useQuery(api.products.search, { ... })`.
    - Ensure the UI correctly handles the Convex loading/error states.
  </action>
  <verify>Verify product list and search work using the Convex backend.</verify>
  <done>Product UI is integrated with Convex.</done>
</task>

</tasks>

<verification>
Verify that browsing products and searching works as expected.
</verification>

<success_criteria>
Storefront product catalog is powered by Convex.
</success_criteria>

<output>
After completion, create `.planning/phases/03-frontend-integration/03-02-SUMMARY.md`
</output>
